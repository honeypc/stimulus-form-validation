{"version":3,"file":"index.umd.js","sources":["../src/error.js","../src/error_renderer.js","../src/index.js"],"sourcesContent":["const defaultMessages = {\n  badInput: \"is invalid\",\n  patternMismatch: \"doesn't match %{pattern}\",\n  rangeOverflow: \"must be less than %{max}\",\n  rangeUnderflow: \"must be greater than %{min}\",\n  stepMismatch: \"number is not divisible by %{step}\",\n  tooLong: \"is too long (maximum is %{maxLength} characters)\",\n  tooShort: \"is too short (minimum is %{minLength} characters)\",\n  typeMismatch: \"is not a valid %{type}\",\n  valueMissing: \"can't be blank\",\n}\n\nconst customMessageAttribute = {\n  badInput: \"is invalid\",\n  patternMismatch: \"patternValidationMessage\",\n  rangeOverflow: \"maxValidationMessage\",\n  rangeUnderflow: \"minValidationMessage\",\n  stepMismatch: \"stepValidationMessage\",\n  tooLong: \"maxlengthValidationMessage\",\n  tooShort: \"minlengthValidationMessage\",\n  typeMismatch: \"typeValidationMessage\",\n  valueMissing: \"requiredValidationMessage\",\n}\n\nexport default class {\n  constructor(el, validationMethodGetter, useHtml5Messages) {\n    this.el = el\n    this.errorType = this.errorType()\n    this.getCustomValidationMethod = validationMethodGetter\n    this.useHtml5Messages = useHtml5Messages\n  }\n\n  message() {\n    if (this.el.validity.valid && !this.customValidationMessage()) {\n      return\n    }\n\n    return (\n      this.customMessage() ||\n      this.defaultMessage() ||\n      this._customValidationMessage\n    )\n  }\n\n  // private\n\n  customMessage() {\n    const dataAttribute = customMessageAttribute[this.errorType]\n\n    return this.el.dataset[dataAttribute]\n  }\n\n  errorType() {\n    const errorTypes = Object.keys(defaultMessages)\n    for (let index = 0; index < errorTypes.length; index++) {\n      if (this.el.validity[errorTypes[index]]) {\n        return errorTypes[index]\n      }\n    }\n  }\n\n  customValidationMessage() {\n    if (this._customValidationMessage) return this._customValidationMessage\n\n    const customValidations = this.el.dataset.validates\n    // scrub text\n    if (!customValidations) return\n\n    this._customValidationMessage = customValidations\n      .split(/\\s+/)\n      .map((validationMethod) => {\n        const method = this.getCustomValidationMethod(validationMethod)\n\n        if (!method) {\n          throw new Error(\n            `Custom validation ${validationMethod} is not defined`\n          )\n        }\n\n        return method(this.el)\n      })\n      .filter((message) => message)[0]\n\n    return this._customValidationMessage\n  }\n\n  defaultMessage() {\n    if (this.useHtml5Messages) {\n      return this.el.validationMessage\n    }\n    const message = defaultMessages[this.errorType]\n\n    return (\n      message &&\n      message.replace(/\\%\\{(.*)}/, (_, match) => {\n        return this.el[match]\n      })\n    )\n  }\n}\n","export default class {\n  constructor(el, errorMessage, config) {\n    this.el = el\n    this.errorMessage = errorMessage\n    this.config = config\n  }\n\n  render() {\n    if (!this.container) return\n    this._insertErrorMessageElement()\n\n    if (this.errorMessage) {\n      this.errorElement.textContent = this.errorMessage\n      this.container.classList.add(this.config.containerErrorClass)\n      this.el.classList.add(this.config.fieldErrorClass)\n    } else {\n      this.container.classList.remove(this.config.containerErrorClass)\n      this.el.classList.remove(this.config.fieldErrorClass)\n      this.errorElement.textContent = \"\"\n    }\n  }\n\n  _insertErrorMessageElement() {\n    if (!this.container.querySelector(\".\" + this.config.errorMessageClass)) {\n      this.container.insertAdjacentHTML(\n        this.errorMessagePosition,\n        `<div class=\"${this.config.errorMessageClass}\"></div>`\n      )\n    }\n  }\n\n  get errorElement() {\n    return this.container.querySelector(\".\" + this.config.errorMessageClass)\n  }\n\n  get container() {\n    return this.el.closest(this.config.containerSelector)\n  }\n\n  get errorMessagePosition() {\n    switch (this.config.errorMessagePosition) {\n      case \"end\":\n        return \"beforeend\"\n      case \"start\":\n        return \"afterbegin\"\n\n      default:\n        return \"beforeend\"\n    }\n  }\n}\n","import ErrorMessage from \"./error\"\nimport ErrorRenderer from \"./error_renderer\"\nimport debounce from \"lodash.debounce\"\n\nimport { Controller } from \"stimulus\"\n\nconst config = {\n  containerSelector: \"[data-field-container]\",\n  errorMessageClass: \"error-message\",\n  useHtml5Messages: false,\n  errorMessagePosition: \"end\", // start/end\n  containerErrorClass: \"container-error\", // any css class\n  fieldErrorClass: \"field-error\", // any css class\n  debounceMs: 150, // integer\n  focusOnError: true, // true/false\n}\n\nexport default class extends Controller {\n  static targets = [\"submit\", \"field\"]\n\n  static config(options = {}) {\n    Object.assign(config, options)\n  }\n\n  mergeConfigOverwrites() {\n    const configKeys = Object.keys(config)\n\n    let result = {}\n    const configClone = Object.assign({}, config)\n    configKeys.forEach((key) => {\n      if (this.data.has(key)) {\n        result[key] = this.data.get(key)\n      }\n    })\n\n    result = Object.assign(configClone, result)\n    result.debounceMs = parseInt(result.debounceMs)\n    result.focusOnError =\n      result.focusOnError === true || result.focusOnError === \"true\"\n    result.useHTML5Messages =\n      result.useHtml5Messages === true || result.useHtml5Messages === \"true\"\n\n    return result\n  }\n\n  connect() {\n    this.form.noValidate = true\n    this.config = this.mergeConfigOverwrites()\n    this.validate = debounce(this.validate.bind(this), this.config.debouncedMs)\n  }\n\n  get form() {\n    if (this.element.nodeName === \"FORM\") {\n      return this.element\n    } else {\n      return this.element.querySelector(\"form\")\n    }\n  }\n\n  validateAll = (event) => {\n    let formValid = true\n\n    this.fieldTargets.forEach((field) => {\n      const error = this._errorMessage(field)\n\n      if (error) {\n        formValid = false\n        this.display(field, error)\n      }\n    })\n\n    if (this.hasSubmitTarget) {\n      this.submitTarget.disabled = !formValid\n    }\n\n    if (!formValid) {\n      event.preventDefault()\n      this._focusFirstInput()\n    }\n  }\n\n  validate(event) {\n    event.preventDefault()\n\n    if (this._isVisitRequired(event.target)) return\n\n    this.display(event.target, this._errorMessage(event.target))\n\n    if (this.hasSubmitTarget) {\n      this.submitTarget.disabled = this._isFormInvalid()\n    }\n  }\n\n  recordVisit = (e) => {\n    e.target.dataset.visited = true\n\n    this.validate(e)\n  }\n\n  display(element, errorMessage) {\n    new ErrorRenderer(element, errorMessage, this.config).render()\n  }\n\n  // private\n\n  _errorMessage(field) {\n    return new ErrorMessage(\n      field,\n      this.validationMethodGetter.bind(this),\n      this.config.useHtml5Messages\n    ).message()\n  }\n\n  validationMethodGetter(methodName) {\n    return this[methodName]\n  }\n\n  _isFieldValid(field) {\n    return !this._errorMessage(field)\n  }\n\n  _focusFirstInput(e) {\n    if (this.data.get(\"focusOnError\") === \"false\") {\n      return\n    }\n\n    const firstInputSelector = [\n      \"text\",\n      \"email\",\n      \"password\",\n      \"search\",\n      \"tel\",\n      \"url\",\n    ].map((type) => `input[type=\"${type}\"]:invalid`)\n\n    this.form.querySelector(firstInputSelector.join(\",\")).focus()\n  }\n\n  _isFormInvalid() {\n    return this.fieldTargets.some((field) => !this._isFieldValid(field))\n  }\n\n  _isVisitRequired(field) {\n    const recordVisitAction = `blur->${this.identifier}#recordVisit`\n\n    if (!field.dataset.action.includes(recordVisitAction)) return false\n    // It's a good practice, not to error until the user visits the field, but only for input fields\n    if (field.nodeName !== \"INPUT\") return false\n    if (field.dataset.visited) return false\n\n    return [\"text\", \"email\", \"password\", \"search\", \"tel\", \"url\"].includes(\n      field.type\n    )\n  }\n}\n"],"names":["defaultMessages","badInput","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valueMissing","customMessageAttribute","el","validationMethodGetter","useHtml5Messages","errorType","getCustomValidationMethod","validity","valid","customValidationMessage","customMessage","defaultMessage","_customValidationMessage","dataAttribute","dataset","errorTypes","Object","keys","index","length","customValidations","validates","split","map","validationMethod","method","Error","filter","message","validationMessage","replace","_","match","errorMessage","config","container","_insertErrorMessageElement","errorElement","textContent","classList","add","containerErrorClass","fieldErrorClass","remove","querySelector","errorMessageClass","insertAdjacentHTML","errorMessagePosition","closest","containerSelector","debounceMs","focusOnError","event","formValid","fieldTargets","forEach","field","error","_errorMessage","display","hasSubmitTarget","submitTarget","disabled","preventDefault","_focusFirstInput","e","target","visited","validate","configKeys","result","configClone","assign","key","data","has","get","parseInt","useHTML5Messages","form","noValidate","mergeConfigOverwrites","debounce","bind","debouncedMs","_isVisitRequired","_isFormInvalid","element","ErrorRenderer","render","ErrorMessage","methodName","firstInputSelector","type","join","focus","some","_isFieldValid","recordVisitAction","identifier","action","includes","nodeName","options","Controller"],"mappings":"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"}